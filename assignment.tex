% Enable warnings about problematic code
\RequirePackage[l2tabu, orthodox]{nag}

\documentclass{WeSTassignment}

% The lecture title, e.g. "Web Information Retrieval".
\lecture{Introduction to Web Science}
% The names of the lecturer and the instructor(s)
\author{%
  Prof. Dr.~Steffen~Staab\\{\normalsize\mailto{staab@uni-koblenz.de}} \and
%   Ren{\'e}~Pickhardt\\{\normalsize\mailto{rpickhardt@uni-koblenz.de}} \and
   Korok~Sengupta\\{\normalsize\mailto{koroksengupta@uni-koblenz.de}} \and 
  Â  Jun~Sun\\{\normalsize\mailto{junsun@uni-koblenz.de}}
}
% Assignment number.
\assignmentnumber{IV}
% Institute of lecture.
\institute{%
  Institute of Web Science and Technologies\\%
  Department of Computer Science\\%
  University of Koblenz-Landau%
}
% Date until students should submit their solutions.
\datesubmission{November 17, 2017, 11:00 a.m.}
% Date on which the assignments will be discussed in the tutorial.
\datetutorial{November 24, 2017, 12:00 p.m.}

% Specify bib file location.
\addbibresource{bibliography.bib}

% For left aligned centerd boxes
% see http://tex.stackexchange.com/a/25591/75225
\usepackage{varwidth}
\usepackage{amsmath}
% ==============================================================================
% Document

\begin{document}

\maketitle
This assignment focuses on the concepts of 1) \textbf{Web Content}, 2) \textbf{Dynamic Web Content}.

For all the assignment questions that require you to write code, make sure to include the code in the answer sheet, along with a separate python file. If you generate a plot from your python script, please add them in the answer sheet.\\ \\ 




%Please mention your team Names here: 
Team Name: XXXX


\section{XML (10 points)}

Your task is to read the text passage below and create a well formed XML document that takes into account all the information presented with regards to the \texttt{researchers}.\\

\texttt{Prof. Dr. Jason Bourne of Identity University,Galway, Ireland was traveling to New York by flight number IC814 for a conference on Computer based Medical Imaging. Incidentally, he met two other researchers Forrest Gump and Don Vito Corleone while boarding the flight who were heading for the same conference as well. While Don had already completed his PhD and is now a having a post doctoral position in Sicilian University, Sicily, Italy, Forrest is still pursuing his PhD in Bubba University, Texas, USA. As luck would have it, all three of them got their seats next to each other on the flight. On the flight, each one was asked for their preferred choice of drinks. While Prof.Dr. Bourne had Chardonay, Forrest settled for a beer and Don was happy with sparkling water. Don asked Prof. Bourne what he was doing at the conference to which he replied, a keynote titled "\textit{Smart Cameras for Smart Doctors}". Hearing that, Forrest got excited and said he too is going to present a paper in similar direction titled "\textit{Smart cameras to detect health hazards}". Don was asked then what he was to do at the conference. He said, a demo presentation on "\textit{Eye tracking and detection of ALS}". }



\subsection*{Solution}
%solution-start
\begin{lstlisting}
<?xml version = "1.0" encoding="UTF-8" standalone="yes"?>
<document>
    <researchers>
        <researcher>
            <name>
                <firstname>
                    Jason
                </firstname>

				<lastname>
					Bourne
				</lastname>
			</name>

			<credential>
				<university>
					Identity University
				</university>

				<location>
					Galway, Ireland
				</location>

				<designation>
					Professor
				</designation>
			</credential>

			<conference>
				<name>
					Computer Based Medical Imaging
				</name>

				<presentationtype>
					keynote
				</presentationtype>

				<title>
					Smart Cameras for Smart Doctors
				</title>
			</conference>

			<flight>
				<number>
					IC814
				</number>

				<drink>
					Chardonay
				</drink>
			</flight>
		</researcher>

		<researcher>
			<name>
				<firstname>
					Forrest
				</firstname>

				<lastname>
					Gump
				</lastname>
			</name>

			<credential>
				<university>
					Bubba University
				</university>

				<location>
					Texas, USA
				</location>

				<designation>
					PhD Student
				</designation>
			</credential>

			<conference>
				<name>
					Computer Based Medical Imaging
				</name>

				<presentationtype>
					paper
				</presentationtype>

				<title>
					Smart Cameras to detect Health Hazads
				</title>
			</conference>

			<flight>
				<number>
					IC814
				</number>

				<drink>
					Beer
				</drink>
			</flight>
		</researcher>

		<researcher>
			<name>
				<firstname>
					Don
				</firstname>

				<lastname>
					Vito Corleone
				</lastname>
			</name>

			<credential>
				<university>
					Sicilian University
				</university>

				<location>
					Sicily, Italy
				</location>

				<designation>
					Post Doctoral researcher
				</designation>
			</credential>

			<conference>
				<name>
					Computer Based Medical Imaging
				</name>

				<presentationtype>
					demo presentation
				</presentationtype>

				<title>
					Eye tracking and detection of ALS
				</title>
			</conference>

			<flight>
				<number>
					IC814
				</number>

				<drink>
					Sparkling Water
				</drink>
			</flight>
		</researcher>
	</researchers>>
</document>
\end{lstlisting}
%solution-end
%-------------------------------------------------------------------------------

\section{Dynamic Web Content (15 points)}

You are provided with \texttt{DynamicWeb.zip} that contains a simple HTTP web server that we have designed for you. It has a simple HTTP registration page (\texttt{localhost:8080/form}) that asks you to enter the first name and email ID to register.\\

Your task is to write a python script that automates the process of registering. 

The \texttt{DynamicWeb.zip} contains \texttt{contacts.txt} that has the different names and email IDs that you need to register automatically through your script. (4 points)

In the the \texttt{template} folder, you will find an html form whose actions you need to automate through your script. The script should look for error messages if the entry that you are trying to register is already in the system or not. If no error message, your entry gets stored in the server. The script should save all the responses from the server and count the number of successful and unsuccessful attempts to register. (5 points)

\begin{enumerate}
\item Please provide a graphical representation of the successful and unsuccessful attempts of registering in a single graph. (2.5 points)
\item Every time you get a response from the server, within it you will also receive the number of elements in the list (on the server). Save the number of list elements you receive after every response(in a file, local to the directory you run your code from), and plot the changes. (3.5 points)
\end{enumerate}

\textbf{Requirements}
\begin{enumerate}
\item You will need to install the \texttt{lpthw.web}\footnote{Use \texttt{pip install lpthw.web} to install the \texttt{lpthw.web} module used for the server. \\For python 3, use \texttt{pip3 install web.py==0.40.dev0}} library in order to run the server.
\item In order to run the server it is necessary to run the \texttt{python bin/app.py} command (\textbf{from the directory that contains the bin directory}).

\end{enumerate}


You may use \texttt{requests} library if required along with \texttt{matplotlib}. 
Please keep in mind that every time you restart the server, the server starts fresh.  
\subsection*{Solution}
%solution-start
\begin{verbatim}

import requests # This can also be eliminated with a simple function.
import matplotlib.pyplot as plt


def send_request(url,data):
    r = requests.post(url, data)
    return r.status_code, r.text

#Contents of contacts.txt
credentials_list = [
    ["Peter", "pete@gmail.com"],
    ["Korok", "korok@yahoo.com"],
    ["Stefan", "stef@gmail.com"],
    ["Lara", "lara@yahoo.com"],
    ["Jun", "jun@gmail.com"],
    ["Igor", "igor@uni-koblenz.com"],
    ["Claudia", "claudia@gmail.com"],
    ["Ivana", "ivana@airbnb.com"],
    ["Husam", "sam@gmail.com"],
    ["Rajesh", "raj@gmail.com"],
]

url = "http://localhost:8080/form"
def status_codes_from_server(url, credentials_list):
    status_codes = []
    txt = []
    for cred in credentials_list:
        data = {"name":cred[0],"email":cred[1]}
        status, text = send_request(url, data)
        status_codes.append(status)
        txt.append(text)
    return status_codes, txt 

def get_unique_codes(code_list):
    codes = []
    for code in code_list:
        if code not in codes:
            codes.append(code)
    return codes
    
def count_codes(code_list):
    codes = {}
    for i in code_list:
        if i not in codes:
            codes[i] = 1
        else:
            codes[i] += 1 
    return codes

def record_list_size(text_list):
    list_size = []
    for i in text_list:
        list_size.append(int(i.split('<em style="color: green; 
                         font-size: 2em;">')[1].split("<")[0]))
    return list_size


code_list, text_list = status_codes_from_server(url, credentials_list)
print(code_list)
print(text_list)
unique_codes = get_unique_codes(code_list)
print(unique_codes)
count_codes = count_codes(code_list)
print(count_codes)


list_size = record_list_size(text_list)

plt.title('List size timeline')
plt.xlabel('number of responses')
plt.ylabel('num of list items')
plt.plot(list_size)
plt.show()


def plot_bar(count_codes, title, xlabel, ylabel):
    d = count_codes
    plt.bar(range(len(d)), d.values(), align="center")
    plt.xticks(range(len(d)), list(d.keys()))
    plt.title(title)
    plt.xlabel(xlabel)
    plt.ylabel(ylabel)
    plt.show()

def error_success_count(text_list):
    count = {}
    for i in range(0,len(text_list)):
        x = text_list[i].split("<p>")[1].split("!")[0]
        if x not in count:
            count[x] = 1
        else:
            count[x] += 1
    return count

error_sucess = error_success_count(text_list)
plot_bar(error_sucess,"Successfuly vs. Unsucessfuly submited", "Frequency", "Responses")

\end{verbatim}

\begin{figure}[h]
  \begin{center}
  \includegraphics[scale = 0.90]{stat.png}
  \caption*{Successful vs. Unsuccessful}
  \label{fig:sincosine}
  \end{center}  
\end{figure}

\begin{figure}[h]
  \begin{center}
  \includegraphics[scale = 0.90]{list_size_timeline.png}
  \caption*{Populating Entries}
  \label{fig:sincosine}
  \end{center}  
\end{figure}
%solution-end

\subsection*{Output - from the server}
%solution-start
\begin{verbatim}
127.0.0.1:50142 - - [08/Nov/2017 11:35:39] "HTTP/1.1 POST /form" - 200 OK
127.0.0.1:50144 - - [08/Nov/2017 11:35:39] "HTTP/1.1 POST /form" - 200 OK
127.0.0.1:50146 - - [08/Nov/2017 11:35:39] "HTTP/1.1 POST /form" - 200 OK
127.0.0.1:50148 - - [08/Nov/2017 11:35:39] "HTTP/1.1 POST /form" - 200 OK
127.0.0.1:50150 - - [08/Nov/2017 11:35:39] "HTTP/1.1 POST /form" - 200 OK
127.0.0.1:50152 - - [08/Nov/2017 11:35:39] "HTTP/1.1 POST /form" - 200 OK
127.0.0.1:50155 - - [08/Nov/2017 11:35:39] "HTTP/1.1 POST /form" - 200 OK
127.0.0.1:50157 - - [08/Nov/2017 11:35:39] "HTTP/1.1 POST /form" - 200 OK
127.0.0.1:50159 - - [08/Nov/2017 11:35:39] "HTTP/1.1 POST /form" - 200 OK
127.0.0.1:50161 - - [08/Nov/2017 11:35:39] "HTTP/1.1 POST /form" - 200 OK
127.0.0.1:50163 - - [08/Nov/2017 11:35:39] "HTTP/1.1 POST /form" - 200 OK
127.0.0.1:50165 - - [08/Nov/2017 11:35:39] "HTTP/1.1 POST /form" - 200 OK
127.0.0.1:50167 - - [08/Nov/2017 11:35:39] "HTTP/1.1 POST /form" - 200 OK
127.0.0.1:50169 - - [08/Nov/2017 11:35:39] "HTTP/1.1 POST /form" - 200 OK
\end{verbatim}
%solution-end
%-------------------------------------------------------------------------------

%-------------------------------------------------------------------------------

\section{Short Questions (5 points)}
1) Why is Meta Data important? (3 points)\\ 
%solution-start
Meta data is often referred to as data about the data and is represented by the \texttt{<meta>} tag. It describes information about the HTML page which usually cannot be represented by any other HTML tags. Meta tags were used by search engines to index web pages based on title, description, and even keywords. Even though the description meta tags have no effect on search engine rank, they do appear in search results. This means that others get to read the description on a search results page before clicking on the link, showing that meta descriptions should be written for people to read rather than for robots to find. Meta data (description, keywords, etc) will increase click-through rates.\\
%solution-end

2) It important to separate content from layout in HTML documents. Give two reasons why? (2 points)\\
%solution-start
Styling content inside the HTML document could lead to inconsistency of styling as one needs to style each element separately. Separating styling from content follows a better approach in not just styling the content but even presenting it across different screen sizes thus reducing a lot of inline styling code.\\
Another advantage of having a separate styling sheet for the content is more flexibility in terms of design. The content remains the same but changing styles of representation of the content becomes easier. 
%solution-end

%-------------------------------------------------------------------------------







\makefooter

\end{document}

